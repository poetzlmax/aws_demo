<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Image Extraction Demo</title>
</head>
<body>
  <h1>Bild hochladen</h1>
  <input type="file" id="fileInput" />
  <button id="uploadBtn">Hochladen</button>
  <pre id="output"></pre>
  <script>
    const API_BASE = 'REPLACE_WITH_API_ENDPOINT';
    const fileInput = document.getElementById('fileInput');
    document.getElementById('uploadBtn').onclick = async () => {
      const file = fileInput.files[0];
      if (!file) return alert('Bitte Datei wÃ¤hlen');
      const reader = new FileReader();
      reader.onload = async () => {
        const b64 = reader.result.split(',')[1];
        const res = await fetch(`${API_BASE}/upload`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ filename: file.name, file: b64 })
        });
        const data = await res.json();
        pollResult(data.key);
      };
      reader.readAsDataURL(file);
    };

    async function pollResult(key) {
      let done = false;
      while (!done) {
        await new Promise(r => setTimeout(r, 3000));
        const res = await fetch(`${API_BASE}/result/${key}`);
        if (res.ok) {
          const out = await res.json();
          document.getElementById('output').textContent = JSON.stringify(out, null, 2);
          done = true;
        }
      }
    }
  </script>
</body>
</html>
